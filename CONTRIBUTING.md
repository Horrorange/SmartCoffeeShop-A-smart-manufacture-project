# ğŸ¤ è´¡çŒ®æŒ‡å— (Contributing Guide)

æ„Ÿè°¢æ‚¨å¯¹ Smart Coffee Shop é¡¹ç›®çš„å…³æ³¨ï¼æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼Œæ— è®ºæ˜¯ä»£ç ã€æ–‡æ¡£ã€æµ‹è¯•è¿˜æ˜¯åé¦ˆå»ºè®®ã€‚

## ğŸ“‹ ç›®å½•

- [è¡Œä¸ºå‡†åˆ™](#è¡Œä¸ºå‡†åˆ™)
- [å¦‚ä½•è´¡çŒ®](#å¦‚ä½•è´¡çŒ®)
- [å¼€å‘ç¯å¢ƒè®¾ç½®](#å¼€å‘ç¯å¢ƒè®¾ç½®)
- [ä»£ç è§„èŒƒ](#ä»£ç è§„èŒƒ)
- [æäº¤è§„èŒƒ](#æäº¤è§„èŒƒ)
- [Pull Request æµç¨‹](#pull-request-æµç¨‹)
- [é—®é¢˜æŠ¥å‘Š](#é—®é¢˜æŠ¥å‘Š)
- [åŠŸèƒ½è¯·æ±‚](#åŠŸèƒ½è¯·æ±‚)
- [æ–‡æ¡£è´¡çŒ®](#æ–‡æ¡£è´¡çŒ®)
- [æµ‹è¯•æŒ‡å—](#æµ‹è¯•æŒ‡å—)

## ğŸŒŸ è¡Œä¸ºå‡†åˆ™

å‚ä¸æœ¬é¡¹ç›®å³è¡¨ç¤ºæ‚¨åŒæ„éµå®ˆæˆ‘ä»¬çš„è¡Œä¸ºå‡†åˆ™ï¼š

- **å°Šé‡ä»–äºº**ï¼šå¯¹æ‰€æœ‰å‚ä¸è€…ä¿æŒå‹å–„å’Œå°Šé‡
- **åŒ…å®¹æ€§**ï¼šæ¬¢è¿ä¸åŒèƒŒæ™¯å’Œç»éªŒæ°´å¹³çš„è´¡çŒ®è€…
- **å»ºè®¾æ€§**ï¼šæä¾›å»ºè®¾æ€§çš„åé¦ˆå’Œå»ºè®®
- **ä¸“ä¸šæ€§**ï¼šä¿æŒä¸“ä¸šçš„æ²Ÿé€šæ–¹å¼
- **å­¦ä¹ æ€åº¦**ï¼šä¿æŒå¼€æ”¾çš„å­¦ä¹ å’Œåˆ†äº«æ€åº¦

## ğŸš€ å¦‚ä½•è´¡çŒ®

### è´¡çŒ®ç±»å‹

æˆ‘ä»¬æ¬¢è¿ä»¥ä¸‹ç±»å‹çš„è´¡çŒ®ï¼š

1. **ğŸ› Bug ä¿®å¤**ï¼šä¿®å¤ç°æœ‰åŠŸèƒ½ä¸­çš„é—®é¢˜
2. **âœ¨ æ–°åŠŸèƒ½**ï¼šæ·»åŠ æ–°çš„åŠŸèƒ½æˆ–æ”¹è¿›ç°æœ‰åŠŸèƒ½
3. **ğŸ“š æ–‡æ¡£æ”¹è¿›**ï¼šæ”¹è¿›æ–‡æ¡£ã€æ·»åŠ ç¤ºä¾‹æˆ–æ•™ç¨‹
4. **ğŸ§ª æµ‹è¯•**ï¼šæ·»åŠ æˆ–æ”¹è¿›æµ‹è¯•ç”¨ä¾‹
5. **ğŸ¨ ä»£ç ä¼˜åŒ–**ï¼šæ€§èƒ½ä¼˜åŒ–ã€ä»£ç é‡æ„
6. **ğŸŒ å›½é™…åŒ–**ï¼šæ·»åŠ å¤šè¯­è¨€æ”¯æŒ
7. **ğŸ“¦ ä¾èµ–ç®¡ç†**ï¼šæ›´æ–°æˆ–ä¼˜åŒ–é¡¹ç›®ä¾èµ–

### è´¡çŒ®æµç¨‹

1. **Fork é¡¹ç›®**åˆ°æ‚¨çš„ GitHub è´¦æˆ·
2. **åˆ›å»ºåˆ†æ”¯**ç”¨äºæ‚¨çš„æ›´æ”¹
3. **è¿›è¡Œå¼€å‘**å¹¶æµ‹è¯•æ‚¨çš„æ›´æ”¹
4. **æäº¤ä»£ç **å¹¶æ¨é€åˆ°æ‚¨çš„ Fork
5. **åˆ›å»º Pull Request**åˆ°ä¸»ä»“åº“

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒè®¾ç½®

### ç¯å¢ƒè¦æ±‚

- Python 3.7+
- Git
- æ¨èä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ

### å®‰è£…æ­¥éª¤

```bash
# 1. Fork å¹¶å…‹éš†é¡¹ç›®
git clone https://github.com/YOUR_USERNAME/SmartCoffeeShop-A-smart-manufacture-project.git
cd SmartCoffeeShop-A-smart-manufacture-project

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/macOS
# æˆ–
venv\Scripts\activate     # Windows

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. å®‰è£…å¼€å‘ä¾èµ–ï¼ˆå¯é€‰ï¼‰
pip install -e ".[dev]"

# 5. éªŒè¯å®‰è£…
python script/grinder/grinder_sim.py --help
```

### å¼€å‘å·¥å…·æ¨è

- **IDE**: VS Code, PyCharm, æˆ–æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨
- **ä»£ç æ ¼å¼åŒ–**: Black
- **ä»£ç æ£€æŸ¥**: Flake8
- **ç±»å‹æ£€æŸ¥**: MyPy
- **æµ‹è¯•**: Pytest

## ğŸ“ ä»£ç è§„èŒƒ

### Python ä»£ç é£æ ¼

æˆ‘ä»¬éµå¾ª [PEP 8](https://pep8.org/) ä»£ç é£æ ¼æŒ‡å—ï¼š

```bash
# ä½¿ç”¨ Black æ ¼å¼åŒ–ä»£ç 
black script/ test/

# ä½¿ç”¨ Flake8 æ£€æŸ¥ä»£ç 
flake8 script/ test/

# ä½¿ç”¨ isort æ’åºå¯¼å…¥
isort script/ test/
```

### ä»£ç è´¨é‡è¦æ±‚

1. **å¯è¯»æ€§**ï¼šä»£ç åº”è¯¥æ¸…æ™°æ˜“æ‡‚
2. **æ³¨é‡Š**ï¼šå¤æ‚é€»è¾‘éœ€è¦é€‚å½“æ³¨é‡Š
3. **æ–‡æ¡£å­—ç¬¦ä¸²**ï¼šæ‰€æœ‰å…¬å…±å‡½æ•°å’Œç±»éœ€è¦æ–‡æ¡£å­—ç¬¦ä¸²
4. **é”™è¯¯å¤„ç†**ï¼šé€‚å½“çš„å¼‚å¸¸å¤„ç†
5. **æµ‹è¯•è¦†ç›–**ï¼šæ–°åŠŸèƒ½éœ€è¦ç›¸åº”çš„æµ‹è¯•

### ç¤ºä¾‹ä»£ç é£æ ¼

```python
def handle_grinder_command(command: int, client: ModbusClient) -> bool:
    """
    å¤„ç†ç£¨ç²‰æœºå‘½ä»¤
    
    Args:
        command: å‘½ä»¤ä»£ç  (0=åœæ­¢, 1=å¼€å§‹ç£¨ç²‰)
        client: Modbuså®¢æˆ·ç«¯å®ä¾‹
        
    Returns:
        bool: å‘½ä»¤æ‰§è¡Œæ˜¯å¦æˆåŠŸ
        
    Raises:
        ConnectionError: å½“æ— æ³•è¿æ¥åˆ°ç£¨ç²‰æœºæ—¶
    """
    try:
        # å‘é€å‘½ä»¤åˆ°ç£¨ç²‰æœº
        success = client.write_single_register(CMD_REG, command)
        if not success:
            logger.error(f"Failed to send command {command} to grinder")
            return False
            
        logger.info(f"Successfully sent command {command} to grinder")
        return True
        
    except Exception as e:
        logger.error(f"Error sending command to grinder: {e}")
        raise ConnectionError(f"Failed to communicate with grinder: {e}")
```

## ğŸ“¤ æäº¤è§„èŒƒ

### æäº¤æ¶ˆæ¯æ ¼å¼

ä½¿ç”¨ [Conventional Commits](https://www.conventionalcommits.org/) æ ¼å¼ï¼š

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

### æäº¤ç±»å‹

- `feat`: æ–°åŠŸèƒ½
- `fix`: Bug ä¿®å¤
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼åŒ–ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- `refactor`: ä»£ç é‡æ„
- `test`: æ·»åŠ æˆ–ä¿®æ”¹æµ‹è¯•
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

### æäº¤ç¤ºä¾‹

```bash
# æ–°åŠŸèƒ½
feat(grinder): add automatic bean level monitoring

# Bug ä¿®å¤
fix(coffee-machine): resolve inventory synchronization issue

# æ–‡æ¡£æ›´æ–°
docs: update installation instructions for Windows

# æµ‹è¯•
test(agent): add unit tests for order processing logic
```

## ğŸ”„ Pull Request æµç¨‹

### åˆ›å»º Pull Request

1. **ç¡®ä¿åˆ†æ”¯æ˜¯æœ€æ–°çš„**ï¼š
   ```bash
   git checkout main
   git pull upstream main
   git checkout your-feature-branch
   git rebase main
   ```

2. **è¿è¡Œæµ‹è¯•**ï¼š
   ```bash
   python -m pytest test/
   ```

3. **æ£€æŸ¥ä»£ç è´¨é‡**ï¼š
   ```bash
   black --check script/ test/
   flake8 script/ test/
   ```

4. **åˆ›å»º Pull Request**å¹¶å¡«å†™æ¨¡æ¿

### Pull Request æ¨¡æ¿

```markdown
## ğŸ“ å˜æ›´æè¿°
ç®€è¦æè¿°æ‚¨çš„æ›´æ”¹å†…å®¹

## ğŸ¯ å˜æ›´ç±»å‹
- [ ] Bug ä¿®å¤
- [ ] æ–°åŠŸèƒ½
- [ ] æ–‡æ¡£æ›´æ–°
- [ ] ä»£ç é‡æ„
- [ ] æµ‹è¯•æ”¹è¿›

## ğŸ§ª æµ‹è¯•
- [ ] å·²æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹
- [ ] æ‰€æœ‰ç°æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ‰‹åŠ¨æµ‹è¯•é€šè¿‡

## ğŸ“‹ æ£€æŸ¥æ¸…å•
- [ ] ä»£ç éµå¾ªé¡¹ç›®è§„èŒƒ
- [ ] å·²æ›´æ–°ç›¸å…³æ–‡æ¡£
- [ ] æäº¤æ¶ˆæ¯ç¬¦åˆè§„èŒƒ
- [ ] å·²è§£å†³æ‰€æœ‰å†²çª

## ğŸ”— ç›¸å…³ Issue
Closes #(issue number)
```

### ä»£ç å®¡æŸ¥

æ‰€æœ‰ Pull Request éƒ½éœ€è¦ç»è¿‡ä»£ç å®¡æŸ¥ï¼š

1. **è‡ªåŠ¨æ£€æŸ¥**ï¼šCI/CD æµæ°´çº¿ä¼šè‡ªåŠ¨è¿è¡Œæµ‹è¯•
2. **äººå·¥å®¡æŸ¥**ï¼šè‡³å°‘ä¸€ä½ç»´æŠ¤è€…ä¼šå®¡æŸ¥æ‚¨çš„ä»£ç 
3. **åé¦ˆå¤„ç†**ï¼šæ ¹æ®åé¦ˆè¿›è¡Œå¿…è¦çš„ä¿®æ”¹
4. **åˆå¹¶**ï¼šå®¡æŸ¥é€šè¿‡åä¼šè¢«åˆå¹¶åˆ°ä¸»åˆ†æ”¯

## ğŸ› é—®é¢˜æŠ¥å‘Š

### æŠ¥å‘Š Bug

å‘ç° Bug æ—¶ï¼Œè¯·åˆ›å»ºè¯¦ç»†çš„ Issueï¼š

1. **ä½¿ç”¨ Bug æŠ¥å‘Šæ¨¡æ¿**
2. **æä¾›å¤ç°æ­¥éª¤**
3. **åŒ…å«é”™è¯¯ä¿¡æ¯å’Œæ—¥å¿—**
4. **è¯´æ˜é¢„æœŸè¡Œä¸º**
5. **æä¾›ç¯å¢ƒä¿¡æ¯**

### Bug æŠ¥å‘Šæ¨¡æ¿

```markdown
## ğŸ› Bug æè¿°
ç®€è¦æè¿°é‡åˆ°çš„é—®é¢˜

## ğŸ”„ å¤ç°æ­¥éª¤
1. å¯åŠ¨ç£¨ç²‰æœºæ¨¡æ‹Ÿå™¨
2. è¿è¡Œå®¢æˆ·ç«¯æµ‹è¯•
3. è§‚å¯Ÿé”™è¯¯

## ğŸ’­ é¢„æœŸè¡Œä¸º
æè¿°æ‚¨æœŸæœ›å‘ç”Ÿçš„æƒ…å†µ

## ğŸ“¸ å®é™…è¡Œä¸º
æè¿°å®é™…å‘ç”Ÿçš„æƒ…å†µ

## ğŸ–¥ï¸ ç¯å¢ƒä¿¡æ¯
- OS: [e.g. macOS 12.0]
- Python: [e.g. 3.9.0]
- é¡¹ç›®ç‰ˆæœ¬: [e.g. 1.0.0]

## ğŸ“‹ é™„åŠ ä¿¡æ¯
æ·»åŠ ä»»ä½•å…¶ä»–æœ‰åŠ©äºè§£å†³é—®é¢˜çš„ä¿¡æ¯
```

## ğŸ’¡ åŠŸèƒ½è¯·æ±‚

### æå‡ºæ–°åŠŸèƒ½

1. **æ£€æŸ¥ç°æœ‰ Issue**ï¼šç¡®ä¿åŠŸèƒ½æœªè¢«æå‡º
2. **ä½¿ç”¨åŠŸèƒ½è¯·æ±‚æ¨¡æ¿**
3. **è¯¦ç»†æè¿°ç”¨ä¾‹**
4. **è€ƒè™‘å®ç°å¤æ‚åº¦**

### åŠŸèƒ½è¯·æ±‚æ¨¡æ¿

```markdown
## ğŸš€ åŠŸèƒ½æè¿°
ç®€è¦æè¿°æ‚¨å¸Œæœ›æ·»åŠ çš„åŠŸèƒ½

## ğŸ’­ åŠ¨æœºå’Œç”¨ä¾‹
è§£é‡Šä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜

## ğŸ“‹ è¯¦ç»†è®¾è®¡
è¯¦ç»†æè¿°åŠŸèƒ½çš„å·¥ä½œæ–¹å¼

## ğŸ”„ æ›¿ä»£æ–¹æ¡ˆ
æè¿°æ‚¨è€ƒè™‘è¿‡çš„å…¶ä»–è§£å†³æ–¹æ¡ˆ

## ğŸ“ é™„åŠ ä¿¡æ¯
æ·»åŠ ä»»ä½•å…¶ä»–ç›¸å…³ä¿¡æ¯æˆ–æˆªå›¾
```

## ğŸ“š æ–‡æ¡£è´¡çŒ®

### æ–‡æ¡£ç±»å‹

- **README**: é¡¹ç›®æ¦‚è¿°å’Œå¿«é€Ÿå¼€å§‹
- **API æ–‡æ¡£**: å‡½æ•°å’Œç±»çš„è¯¦ç»†è¯´æ˜
- **æ•™ç¨‹**: åˆ†æ­¥æŒ‡å¯¼å’Œç¤ºä¾‹
- **FAQ**: å¸¸è§é—®é¢˜è§£ç­”

### æ–‡æ¡£è§„èŒƒ

1. **æ¸…æ™°ç®€æ´**ï¼šä½¿ç”¨ç®€å•æ˜äº†çš„è¯­è¨€
2. **ç»“æ„åŒ–**ï¼šä½¿ç”¨æ ‡é¢˜å’Œåˆ—è¡¨ç»„ç»‡å†…å®¹
3. **ç¤ºä¾‹ä¸°å¯Œ**ï¼šæä¾›å®é™…çš„ä»£ç ç¤ºä¾‹
4. **ä¿æŒæ›´æ–°**ï¼šç¡®ä¿æ–‡æ¡£ä¸ä»£ç åŒæ­¥

## ğŸ§ª æµ‹è¯•æŒ‡å—

### æµ‹è¯•ç±»å‹

1. **å•å…ƒæµ‹è¯•**ï¼šæµ‹è¯•å•ä¸ªå‡½æ•°æˆ–æ–¹æ³•
2. **é›†æˆæµ‹è¯•**ï¼šæµ‹è¯•ç»„ä»¶é—´çš„äº¤äº’
3. **ç«¯åˆ°ç«¯æµ‹è¯•**ï¼šæµ‹è¯•å®Œæ•´çš„å·¥ä½œæµç¨‹

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
python -m pytest test/test_grinder.py

# è¿è¡Œå¸¦è¦†ç›–ç‡çš„æµ‹è¯•
python -m pytest --cov=script

# è¿è¡Œç‰¹å®šæ ‡è®°çš„æµ‹è¯•
python -m pytest -m "not slow"
```

### ç¼–å†™æµ‹è¯•

```python
import pytest
from script.grinder.grinder_sim import GrinderSimulator

class TestGrinderSimulator:
    def setup_method(self):
        """æ¯ä¸ªæµ‹è¯•æ–¹æ³•å‰çš„è®¾ç½®"""
        self.grinder = GrinderSimulator()
    
    def test_initial_state(self):
        """æµ‹è¯•åˆå§‹çŠ¶æ€"""
        assert self.grinder.status == 0  # ç©ºé—²çŠ¶æ€
        assert self.grinder.bean_level == 100  # æ»¡è±†
    
    def test_start_grinding(self):
        """æµ‹è¯•å¼€å§‹ç£¨ç²‰"""
        result = self.grinder.start_grinding()
        assert result is True
        assert self.grinder.status == 1  # ç£¨ç²‰ä¸­
    
    @pytest.mark.parametrize("bean_level", [0, 5, 10])
    def test_low_bean_level(self, bean_level):
        """æµ‹è¯•ä½è±†é‡æƒ…å†µ"""
        self.grinder.bean_level = bean_level
        result = self.grinder.start_grinding()
        assert result is False
```

## ğŸ·ï¸ ç‰ˆæœ¬å‘å¸ƒ

### ç‰ˆæœ¬å·è§„èŒƒ

æˆ‘ä»¬ä½¿ç”¨ [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/)ï¼š

- **ä¸»ç‰ˆæœ¬å·**ï¼šä¸å…¼å®¹çš„ API ä¿®æ”¹
- **æ¬¡ç‰ˆæœ¬å·**ï¼šå‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
- **ä¿®è®¢å·**ï¼šå‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£

### å‘å¸ƒæµç¨‹

1. **æ›´æ–°ç‰ˆæœ¬å·**ï¼šåœ¨ `setup.py` ä¸­æ›´æ–°ç‰ˆæœ¬
2. **æ›´æ–° CHANGELOG**ï¼šè®°å½•æ‰€æœ‰å˜æ›´
3. **åˆ›å»º Release**ï¼šåœ¨ GitHub ä¸Šåˆ›å»ºæ–°çš„ Release
4. **å‘å¸ƒåˆ° PyPI**ï¼šï¼ˆå¦‚æœé€‚ç”¨ï¼‰

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚æœæ‚¨åœ¨è´¡çŒ®è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–å¸®åŠ©ï¼š

1. **æŸ¥çœ‹æ–‡æ¡£**ï¼šé¦–å…ˆæŸ¥çœ‹é¡¹ç›®æ–‡æ¡£å’Œ FAQ
2. **æœç´¢ Issue**ï¼šæŸ¥çœ‹æ˜¯å¦æœ‰ç±»ä¼¼çš„é—®é¢˜å·²è¢«è®¨è®º
3. **åˆ›å»º Issue**ï¼šå¦‚æœæ‰¾ä¸åˆ°ç­”æ¡ˆï¼Œåˆ›å»ºæ–°çš„ Issue
4. **è”ç³»ç»´æŠ¤è€…**ï¼šé€šè¿‡é‚®ä»¶ horrorange@qq.com è”ç³»

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸º Smart Coffee Shop é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼æ‚¨çš„è´¡çŒ®è®©è¿™ä¸ªé¡¹ç›®å˜å¾—æ›´å¥½ã€‚

### è´¡çŒ®è€…åˆ—è¡¨

- **Orange** - é¡¹ç›®åˆ›å»ºè€…å’Œä¸»è¦ç»´æŠ¤è€…

---

å†æ¬¡æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼è®©æˆ‘ä»¬ä¸€èµ·æ„å»ºæ›´å¥½çš„æ™ºèƒ½å’–å•¡åº—ç³»ç»Ÿï¼ â˜•ï¸âœ¨